#!/bin/bash

set -euo pipefail
shopt -s inherit_errexit

echo "Updating package lists..."
sudo apt update
echo "Installing packages..."
sudo apt install seclists curl enum4linux gobuster nbtscan nikto nmap onesixtyone\
  oscanner smbclient smbmap smtp-user-enum snmp sslscan sipvicious tnscmd10g whatweb\
  wkhtmltopdf

echo "Installing autorecon..."
pipx upgrade git+https://github.com/Tib3rius/AutoRecon.git

echo "Installing pwncat..."
if [ ! -d ~/.pwncat-env ]; then
  python -m venv ~/.pwncat-env
fi
# Activate venv
source ~/.pwncat-env/bin/activate

# Install/upgrade pwncat
pip install --upgrade git+https://github.com/calebstewart/pwncat.git

if [ ! -f ~/.local/bin/pcat ]; then
  # Make it available even when venv isn't activated
  ln -s ~/.pwncat-env/bin/pwncat $HOME/.local/bin/pcat
fi

deactivate


# Sadly, version has to be bumped manually, so check for install
if [ ! -d ~/.ghidra ]; then
  echo "Installing ghidra..."
  wget -O ~/Downloads/ghidra.zip https://ghidra-sre.org/ghidra_9.2_PUBLIC_20201113.zip
  ldir=$(pwd)
  cd ~
  unzip ~/Downloads/ghidra.zip
  mv ghidra* .ghidra
  rm ~/Downloads/ghidra.zip
  echo "Ghidra installed to ~/.ghidra"
  cd $ldir
else
  echo "Ghidra already installed."
fi
